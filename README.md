# Домашнее задание: Создание REST API на FastApi

Оригинальное задание Netology: [Создание REST API на FastApi](https://github.com/netology-code/py-homeworks-web/tree/new/3.1-fast-api-1)

## Описание задания

Разработка и докеризация REST API сервиса объявлений купли/продажи с использованием FastAPI. Сервис должен поддерживать CRUD-операции (создание, чтение, обновление, удаление) для объявлений, а также поиск по полям. Использование SQLite в качестве базы данных. Авторизация и аутентификация не требуются.

## Мое решение

Проект представляет собой REST API сервис для управления объявлениями купли/продажи, реализованный с использованием FastAPI.

**Отличия от оригинального задания Netology:**
*   Вместо SQLite используется **PostgreSQL** в качестве основной базы данных.
*   Реализована **аутентификация и авторизация** пользователей (с ролями "user" и "admin"), хотя в задании это не требовалось.

**Архитектура:**
*   **FastAPI:** Высокопроизводительный веб-фреймворк для создания API.
*   **PostgreSQL:** Реляционная база данных для хранения объявлений и пользовательских данных.
*   **SQLAlchemy:** ORM для взаимодействия с базой данных.
*   **Uvicorn:** ASGI-сервер для запуска FastAPI-приложения.
*   **Docker, Docker Compose:** Для контейнеризации и оркестрации сервисов.

**Основные функции:**
*   **Управление объявлениями:** Полный набор CRUD-операций (создание, чтение, обновление, удаление) для объявлений.
*   **Поиск объявлений:** Возможность поиска объявлений по различным полям.
*   **Управление пользователями:** Создание пользователей и администраторов, логин, удаление пользователей (для администраторов).
*   **Аутентификация и авторизация:** Защита эндпоинтов с использованием токенов.
*   **Миграции базы данных:** Используется Alembic для управления изменениями схемы базы данных.

**Используемые технологии:**
*   Python 3.10
*   FastAPI
*   Uvicorn
*   PostgreSQL
*   SQLAlchemy, asyncpg, psycopg2-binary
*   Pydantic (для валидации данных)
*   Alembic (для миграций БД)
*   Bcrypt (для хеширования паролей)
*   Docker, Docker Compose

## Структура проекта

```
.
├── .dockerignore               # Файлы и папки, игнорируемые при сборке Docker-образа
├── .env                        # Переменные окружения
├── .gitignore                  # Файлы и папки, игнорируемые Git
├── client.py                   # Скрипт для тестирования API
├── docker-compose.yml          # Конфигурация Docker Compose для запуска сервисов (app, db)
├── Dockerfile                  # Определение Docker-образа для FastAPI-приложения
├── pyvenv.cfg                  # Конфигурация виртуального окружения
├── requirements.txt            # Список зависимостей Python
└── app/                        # Основное FastAPI-приложение
    ├── auth.py                 # Логика аутентификации и авторизации
    ├── config.py               # Конфигурация приложения
    ├── constants.py            # Константы
    ├── crud.py                 # Логика для CRUD-операций с базой данных
    ├── custom_types.py         # Пользовательские типы
    ├── dependancy.py           # Управление зависимостями
    ├── lifespan.py             # Управление жизненным циклом приложения
    ├── models.py               # Определение моделей SQLAlchemy
    ├── recreate_db.sh          # Скрипт для пересоздания базы данных
    ├── schema.py               # Определение Pydantic-схем
    └── server.py               # Основной файл FastAPI-приложения, определение роутов
```

## Инструкции по запуску

Для запуска проекта убедитесь, что у вас установлен Docker и Docker Compose.

1.  **Клонируйте репозиторий:**
    ```bash
    git clone https://github.com/YOUR_USERNAME/fastapi.git
    cd fastapi
    ```

2.  **Запустите сервисы с помощью Docker Compose:**
    ```bash
    docker compose up --build
    ```

3.  **Доступ к API:**
    *   FastAPI-приложение будет доступно по адресу `http://localhost:8000`.
    *   Документация API (Swagger UI) доступна по адресу `http://localhost:8000/docs`.
    *   Альтернативная документация (ReDoc) доступна по адресу `http://localhost:8000/redoc`.

4.  **Запуск клиентского скрипта:**
    После запуска сервисов вы можете использовать `client.py` для тестирования API:
    ```bash
    docker compose exec app python client.py
    ```
    Или, если вы хотите запустить клиент локально (убедитесь, что у вас установлены зависимости из `requirements.txt`):
    ```bash
    pip install -r requirements.txt
    python client.py
    ```